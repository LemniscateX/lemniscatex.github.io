<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lemniscatex.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="《JavaScript高级程序设计》第十章，DOM。">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript学习笔记(10)">
<meta property="og:url" content="https://lemniscatex.github.io/js-note-10/index.html">
<meta property="og:site_name" content="咱是小羊">
<meta property="og:description" content="《JavaScript高级程序设计》第十章，DOM。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://lemniscatex.github.io/js-note-10/dom-example.png">
<meta property="og:image" content="https://lemniscatex.github.io/js-note-10/comparison.png">
<meta property="article:published_time" content="2020-03-31T07:33:02.000Z">
<meta property="article:modified_time" content="2021-01-20T23:44:30.000Z">
<meta property="article:tag" content="DOM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lemniscatex.github.io/js-note-10/dom-example.png">

<link rel="canonical" href="https://lemniscatex.github.io/js-note-10/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>JavaScript学习笔记(10) | 咱是小羊</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">咱是小羊</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-projects">

    <a href="/projects/" rel="section"><i class="fa fa-magic fa-fw"></i>Projects</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lemniscatex.github.io/js-note-10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar/avatar.jpg">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="咱是小羊">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JavaScript学习笔记(10)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-31 15:33:02" itemprop="dateCreated datePublished" datetime="2020-03-31T15:33:02+08:00">2020-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-21 07:44:30" itemprop="dateModified" datetime="2021-01-21T07:44:30+08:00">2021-01-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>《JavaScript高级程序设计》第十章，DOM。</p>
<span id="more"></span>

<hr>
<p>DOM(文档对象模型)是针对HTML和XML文档的一个API。</p>
<h2 id="节点层次"><a href="#节点层次" class="headerlink" title="节点层次"></a>节点层次</h2><p>DOM可以将任何HTML或XML文档描绘成一个由多层节点构成的结构。每个文档都只有一个根节点，叫做文档节点。每一段标记都可以通过树的一个节点表示：HTML元素用元素节点，特性(attribute)用特性节点，文档类型用文档节点，注释用注释节点，总共有12种节点类型，它们都继承自一个基类型。举个例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Simple page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/js-note-10/dom-example.png" class="" title="dom-example">

<h3 id="Node类型"><a href="#Node类型" class="headerlink" title="Node类型"></a>Node类型</h3><p>DOM1级定义了一个Node接口，该接口由DOM中的所有节点类型实现，该接口在JavaScript中作为Node类型实现。JavaScript中的所有节点类型都继承自Node类型。在除IE外的所有浏览器中都可以访问到这个类型。</p>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType<ul>
<li>Node.ELEMENT_NODE：1</li>
<li>Node.ATTRIBUTE_NODE：2</li>
<li>Node.TEXT_NODE：3</li>
<li>Node.CDATA_SECTION_NODE：4</li>
<li>Node.ENTITY_REFERENCE_NODE：5</li>
<li>Node.ENTITY_NODE：6</li>
<li>Node.PROCESSING_INSTRUCTION_NODE：7</li>
<li>Node.COMMENT_NODE：8</li>
<li>Node.DOCUMENT_NODE：9</li>
<li>Node.DOCUMENT_TYPE_NODE：10</li>
<li>Node.DOCUMENT_FRAGMENT_NODE：11</li>
<li>Node.NOTATION_NODE：12</li>
</ul>
</li>
</ul>
<p>每个节点都有nodeType属性，表明节点的类型，由上述12个数值常量表示。通过和以上常量的比对可以知道节点的类型。由于IE中未公开Node类型的构造函数，所以在IE中只能通过数值的比较来判断。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 适用于除IE外浏览器</span></span><br><span class="line"><span class="keyword">if</span>(someNode.nodeType == Node.ELEMENT_NODE) &#123;</span><br><span class="line">    alert(<span class="string">&quot;Node is an element&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 适用于所有浏览器</span></span><br><span class="line"><span class="keyword">if</span>(someNode.nodeType == <span class="number">1</span>) &#123;</span><br><span class="line">    alert(<span class="string">&quot;Node is an element&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>nodeName和nodeValue<br>俩属性的值取决于节点的类型，如对于元素节点来说，nodeName是元素的标签名，nodeValue始终为null。</p>
</li>
<li><p>ownerDocument<br>指向表示整个文档的文档节点。这种关系意为任何节点都属于它所在的文档，任何节点都不能同时存在于多个文档中。</p>
</li>
</ul>
<h4 id="节点关系"><a href="#节点关系" class="headerlink" title="节点关系"></a>节点关系</h4><ul>
<li>childNodes</li>
</ul>
<p>每个节点都有一个childNodes属性，其中保存着一个NodeList对象。NodeLists是一种类数组对象，但不是Array的实例。NodeLists实际上是基于DOM结构动态执行查询的结果，因此DOM结构的变化能够自动反映在NodeLists对象中。下面展示对其的访问：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> firstChild = someNode.childNodes[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">var</span> secondChild = someNode.childNodes.item(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> count = someNode.childNodes.length;</span><br></pre></td></tr></table></figure>
<p>如果向将其转为Array，可以使用<code>Array.prototype.slice()</code>，不过在IE8以及更早版本上，NodeLists是COM对象，因此我们不能对其使用JScript对象的方法，必须手动枚举。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 适用于除IE8之前外浏览器</span></span><br><span class="line"><span class="keyword">var</span> arrayOfNodes = <span class="built_in">Array</span>.prototype.slice.call(someNode.childNodes, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 适用于所有浏览器</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">convertToArray</span>(<span class="params">nodes</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> array = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        array = <span class="built_in">Array</span>.prototype.slice.call(nodes, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(ex) &#123;                                <span class="comment">// 相当于检测怪癖</span></span><br><span class="line">        array = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, len = nodes.length; i &lt; len; i++) &#123;</span><br><span class="line">            array.push(nodes[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>firstChild</li>
<li>lastChild</li>
<li>previousSibling</li>
<li>nextSibling</li>
<li>parentNode</li>
<li>hasChildNodes()</li>
</ul>
<p>以上在边界情况下值均为null，如第一个子节点的previousSibling、最后一个子节点的nextSibling等。</p>
<h4 id="节点操作"><a href="#节点操作" class="headerlink" title="节点操作"></a>节点操作</h4><p>因为关系指针都是只读的，所以DOM提供了一些操作节点的方法。</p>
<ul>
<li><p>appendChild()<br>接收一个参数：要添加的节点，返回之。如果传入的节点已为文档一部分，则结果为将该节点从原位置转移到新位置。</p>
</li>
<li><p>insertBefore()<br>接收两个参数：要插入的节点、作为参照的节点，返回被插入的节点。如果参照的节点是null，则此方法和appendChild()执行相同操作。</p>
</li>
<li><p>replaceChild()<br>接收两个参数：要插入的节点、被替换的节点，返回被替换的节点。过程为新节点的所有关系指针由旧节点复制而来，技术上旧节点仍存在于文档中，但它在文档中已无自己的位置。</p>
</li>
<li><p>removeChild()<br>接收一个参数：要移除的节点，返回之。同样事实上仍存在但已无自己的位置。</p>
</li>
<li><p>cloneNode()<br>用于创建调用该方法的节点的副本，接收一个布尔值参数，表示是否执行深复制，返回副本。传入true时深复制，即复制节点及其整个子节点树；传入false时浅复制，即只复制节点本身。该方法不会复制添加到DOM节点中的JavaScript属性，如事件处理器等。副本属于文档所有，但并没有为其指定父节点，不过可以通过使用<code>appendChild()</code>等方法为其指定关系。</p>
</li>
<li><p>normalize()<br>用于处理文档树中的文本节点。由于一些原因可能会出现文本节点不包含文本、连续出现两个文本节点的情况，当某个节点调用此方法时，可以在该节点的后代节点中查找上述两种情况。处理方法为对空文本节点进行删除，对相邻文本节点进行合并。</p>
</li>
</ul>
<h3 id="Document类型"><a href="#Document类型" class="headerlink" title="Document类型"></a>Document类型</h3><p>JavaScript用Document类型表示HTML页面或其他基于XML的文档。浏览器中的document对象是继承自Document的HTMLDocument的实例，也是window对象的一个属性。</p>
<h4 id="属性-1"><a href="#属性-1" class="headerlink" title="属性"></a>属性</h4><ul>
<li><p>nodeType：9</p>
</li>
<li><p>nodeName：”#document”</p>
</li>
<li><p>nodeValue：null</p>
</li>
<li><p>parentNode：null</p>
</li>
<li><p>childNodes：DocumentType、Element、ProcessingInstruction、Comment</p>
</li>
<li><p>ownerDocument：null</p>
</li>
<li><p>documentElement<br>指向HTML页面的&lt;html&gt;元素。</p>
</li>
<li><p>body<br>指向HTML页面的&lt;body&gt;元素。</p>
</li>
<li><p>doctype<br>指向HTML页面的&lt;!DOCTYPE&gt;元素。不同浏览器对其的支持不一致，不赘述。</p>
</li>
</ul>
<p>* document特有属性<br>document对象有一些标准Document对象没有的属性，它们提供了document对象所表现的网页的一些信息，包括：</p>
<ul>
<li>document.title：标题</li>
<li>document.URL：地址栏中的完整URL</li>
<li>document.domain：页面域名</li>
<li>document.referrer：链接到当前页面的那个页面的URL</li>
</ul>
<p>document对象还有一些特殊集合，它们都是HTMLCollection对象，包括：</p>
<ul>
<li>document.anchors：所有带name特性的&lt;a&gt;元素</li>
<li>document.applets：所有&lt;applet&gt;元素</li>
<li>document.forms：所有&lt;form&gt;元素</li>
<li>document.images：所有&lt;img&gt;元素</li>
<li>document.links：所有带href特性的&lt;a&gt;元素</li>
</ul>
<h4 id="查找操作"><a href="#查找操作" class="headerlink" title="查找操作"></a>查找操作</h4><ul>
<li><p>getElementById()<br>大小写敏感，如果有多个相同id的元素则返回文档中第一个元素。</p>
</li>
<li><p>getElementByTagName()<br>大小写不敏感，返回包含零或多个元素的NodeList。在HTML文档中则返回一个HTMLCollection对象。若传入*则会返回所有元素。</p>
</li>
</ul>
<p>* HTMLCollection<br>作为一个动态集合，它于NodeList很类似，因此也可以用下标和<code>item()</code>方法。除此之外还可以使用方括号和<code>namedItem()</code>方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> images = <span class="built_in">document</span>.getElementByTagName(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">alert(images.length);</span><br><span class="line">alert(images[<span class="number">0</span>].src);</span><br><span class="line">alert(images.item(<span class="number">0</span>).src);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问name为myImage的img元素</span></span><br><span class="line"><span class="keyword">var</span> myImage = images[<span class="string">&quot;myImage&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> myImage = images.namedItem(<span class="string">&quot;myImage&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>*document特有操作<br><code>getElementByName()</code>会返回带有给定name特性的所有元素的一个HTMLCollection。</p>
<h4 id="写入操作"><a href="#写入操作" class="headerlink" title="写入操作"></a>写入操作</h4><p>document有将输入流写入网页的能力，具体来说是使用以下方法：<code>write()</code>、<code>writeln()</code>、<code>open()</code>、<code>close()</code>。前两者均接收一个字符串，前者会原样写入，后者会在字符串末尾添加换行符。在页面被加载时，它们可以向页面中动态地加入内容。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>document-write Example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>The current date and time is:</span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.write(<span class="string">&quot;&lt;strong&gt;&quot;</span> + (<span class="keyword">new</span> <span class="built_in">Date</span>()).toString() + <span class="string">&quot;&lt;/strong&gt;&quot;</span>);</span></span><br><span class="line"><span class="javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>该例子使用<code>document.write()</code>在页面被呈现的过程中直接向其中输出了内容。但如果在文档结束后再调用<code>document.write()</code>，那么输出的内容将重写整个页面。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>document-write Example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This content couldn&#x27;t be shown because it will be overwritten<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.write(<span class="string">&quot;Hello world!&quot;</span>);</span></span><br><span class="line"><span class="javascript">        &#125;;</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Element类型"><a href="#Element类型" class="headerlink" title="Element类型"></a>Element类型</h3><p>Element类型用于表现XML或HTML元素，提供对元素标签名、子节点和特性的访问。</p>
<h4 id="属性-2"><a href="#属性-2" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType：1</li>
<li>nodeName：元素的标签名</li>
<li>nodeValue：null</li>
<li>parentNode：Document、Element</li>
<li>childNodes：Element、Text、Comment、ProcessingInstruction、CDATASection、EntityReference</li>
<li>tagName：元素的标签名，为全大写，与nodeName相等</li>
</ul>
<p>要注意不同浏览器的区别，举个例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;myList&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>对如上的代码，大部分浏览器解析的结果为：&lt;ul&gt;元素包含3个子节点，分别是3个&lt;li&gt;元素；IE浏览器解析第结果为：&lt;ul&gt;元素包含7个子节点，分别是3个&lt;li&gt;元素和4个文本节点(元素之间的空白符)。因此如果是要遍历子节点，一定不要忘了浏览器间的差异。</p>
<ul>
<li>attributes</li>
</ul>
<p>attributes属性中包含一个NamedNodeMap，与NodeList，是一个动态的集合。元素的每个属性都用一个Attr节点表示，并被保存在NamedNodeMap对象中，节点的nodeName为特性名，nodeValue为特性值。NamedNodeMap对象拥有以下方法：<code>getNamedItem(name)</code>、<code>removeNamedItem(name)</code>、<code>setNamedItem(node)</code>、<code>item(pos)</code>。分别用来获取、移除、添加、返回pos位置的节点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> id = element.attributes.getNamedItem(<span class="string">&quot;id&quot;</span>).nodeValue;</span><br><span class="line"><span class="keyword">var</span> id = element.attributes[<span class="string">&quot;id&quot;</span>].nodeValue;</span><br><span class="line"><span class="keyword">var</span> oldAttr = element.attributes.removeNamedItem(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">element.attributes.setNamedItem(newAttr);</span><br></pre></td></tr></table></figure>

<p>* HTML元素特有属性<br>所有HTML元素都由HTMLElement类型标识，HTMLElement类型继承了Element类型，并添加了一些属性：</p>
<ul>
<li>id：元素id</li>
<li>title：元素附加说明信息，一般通过工具提示条显示</li>
<li>lang：元素内容的语言代码</li>
<li>dir：语言的方向，值为”ltr”(left-to-right)、”rtl”(right-to-left)</li>
<li>className：元素的class</li>
</ul>
<h4 id="特性操作"><a href="#特性操作" class="headerlink" title="特性操作"></a>特性操作</h4><p>每个元素都有一个或多个特性，用于给出相应元素或其内容的附加信息。</p>
<ul>
<li>getAttribute()</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span> <span class="attr">class</span>=<span class="string">&quot;bd&quot;</span> <span class="attr">title</span>=<span class="string">&quot;Body text&quot;</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">dir</span>=<span class="string">&quot;ltr&quot;</span><span class="attr">myAttr</span>=<span class="string">&quot;hello&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myDiv&quot;</span>);</span><br><span class="line">alert(div.getAttribute(<span class="string">&quot;id&quot;</span>));         <span class="comment">// &quot;myDiv&quot;</span></span><br><span class="line">alert(div.getAttribute(<span class="string">&quot;title&quot;</span>));      <span class="comment">// &quot;Body text&quot;</span></span><br><span class="line">alert(div.getAttribute(<span class="string">&quot;lang&quot;</span>));       <span class="comment">// &quot;en&quot;</span></span><br><span class="line">alert(div.getAttribute(<span class="string">&quot;DIR&quot;</span>));        <span class="comment">// &quot;ltr&quot;</span></span><br><span class="line">alert(div.getAttribute(<span class="string">&quot;class&quot;</span>));      <span class="comment">// &quot;bd&quot;</span></span><br><span class="line">alert(div.getAttribute(<span class="string">&quot;myAttr&quot;</span>));     <span class="comment">// &quot;hello&quot;</span></span><br><span class="line"></span><br><span class="line">alert(div.id);                         <span class="comment">// &quot;myDiv&quot;</span></span><br><span class="line">alert(div.myAttr);                     <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>注意传递的特性名与实际的特性名相同，因此要得到class特性值应该用<code>getAttribute(&quot;class&quot;)</code>而非<code>getAttribute(&quot;className&quot;)</code>。特性的名称是大小写不敏感的。还可以像例子一样自定义特性，不过根据HTML5规范，自定义特性应加上data-前缀；且只有公认的特性才会以属性的形式添加到DOM对象中。有两类特殊的特性，它们虽然有对应的属性名，但属性的值与通过<code>getAttribute()</code>返回的值的类型不一样，它们是style特性和诸如onclick这样的事件处理特性，二者属性值均为对象，但<code>getAttribute()</code>返回的值则为字符串。</p>
<ul>
<li>setAttribute()</li>
</ul>
<p>接收两个参数：要设置的特姓名、值。如果特性已存在则替换，如果特性不存在则创建该属性并设置相应的值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">div.setAttribute(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;someOtherId&quot;</span>);</span><br><span class="line">div.setAttribute(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;ft&quot;</span>);</span><br><span class="line">div.setAttribute(<span class="string">&quot;TITLE&quot;</span>, <span class="string">&quot;Some other text&quot;</span>);</span><br><span class="line"></span><br><span class="line">div.myAttr = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">alert(div.getAttribute(<span class="string">&quot;myAttr&quot;</span>));     <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<p>通过该方法设置的特姓名会被统一转换为小写形式。注意如果像后面那样为DOM元素添加一个自定义的属性，该属性不会自动成为元素的特性。</p>
<ul>
<li><p>removeAttribute()<br>用于彻底删除元素的特性，即不仅删除特性值，还会彻底删除特性。</p>
</li>
<li><p>getAttributeNode()<br>这个返回的是Attr类型的节点，不过不建议操作节点，直接用以上方法更方便。</p>
</li>
<li><p>setAttributeNode()<br>这个返回的是Attr类型的节点，不过不建议操作节点，直接用以上方法更方便。</p>
</li>
</ul>
<h4 id="创建操作"><a href="#创建操作" class="headerlink" title="创建操作"></a>创建操作</h4><p>可以使用<code>document.createElement()</code>方法创建新元素，接收一个参数：要创建的元素的标签名。不过新元素尚未被添加到文档树中，可以使用<code>appendChild()</code>等来将其进行添加。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>在IE中可以使用另一种传参模式，接收一个参数：完整的元素标签。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">&quot;&lt;div id=\&quot;myNewDiv\ class=\&quot;box\&quot;&quot;</span>&gt;&lt;/div&gt;<span class="string">&quot;);</span></span><br></pre></td></tr></table></figure>

<h3 id="Text类型"><a href="#Text类型" class="headerlink" title="Text类型"></a>Text类型</h3><p>为文本节点，包含纯文本内容。可包含转义后的HTML字符，但不能包含HTML代码。</p>
<h4 id="属性-3"><a href="#属性-3" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType：3</li>
<li>nodeName：”#text”</li>
<li>nodeValue：包含的文本</li>
<li>parentNode：Element</li>
<li>childNodes：无</li>
<li>data：包含的文本</li>
<li>length：节点中字符数目</li>
</ul>
<h4 id="文本操作"><a href="#文本操作" class="headerlink" title="文本操作"></a>文本操作</h4><ul>
<li><p>appendData(text)<br>将text添加到节点末尾。</p>
</li>
<li><p>deleteData(offset, count)<br>从offset指定的位置开始删除count个字符。</p>
</li>
<li><p>insertData(offset, text)<br>从offset指定的位置插入text。</p>
</li>
<li><p>replaceData(offset, count, text)<br>用text替换从offset指定的位置开始到offset+count为止处的字符。</p>
</li>
<li><p>substringData(offset, count)<br>提取从offset指定的位置开始到offset+count为止处的字符。</p>
</li>
<li><p>splitText(offset)<br>从offset指定的位置将文本节点分成两个文本节点。原节点的文本变为前部分的字符，新节点的文本为后部分的字符，返回新节点。</p>
</li>
<li><p>normalize()<br>与<code>splitText()</code>效果相反，不接收参数。在一个包含两个或多个文本节点的父元素上调用此方法，可以将所有文本节点合并为一个节点，结果节点的nodeValue等于合并前每个文本节点的nodeValue值拼接起来的值。</p>
</li>
</ul>
<h4 id="创建操作-1"><a href="#创建操作-1" class="headerlink" title="创建操作"></a>创建操作</h4><p>可以使用<code>document.createTextNode()</code>方法创建文本节点，接收一个参数：要插入节点中的文本。不过新节点尚未被添加到文档树中，可以使用<code>appendChild()</code>等来将其进行添加。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 其实文本会转为&quot;&amp;lt;strong&amp;gt;Hello&amp;lt;/strong&amp;gt;world!&quot;</span></span><br><span class="line"><span class="keyword">var</span> textNode = <span class="built_in">document</span>.createTextNode(<span class="string">&quot;&lt;strong&gt;Hello&lt;/strong&gt;word!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">element.appendChild(textNode);</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(element);</span><br></pre></td></tr></table></figure>

<h3 id="Comment类型"><a href="#Comment类型" class="headerlink" title="Comment类型"></a>Comment类型</h3><p>为注释，和Text类型继承自相同的基类，因此拥有除了<code>splitText()</code>之外的所有字符串操作方法。</p>
<h4 id="属性-4"><a href="#属性-4" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType：8</li>
<li>nodeName：”#comment”</li>
<li>nodeValue：注释的内容</li>
<li>parentNode：Document、Element</li>
<li>childNodes：无</li>
<li>data：注释的内容</li>
</ul>
<h4 id="创建操作-2"><a href="#创建操作-2" class="headerlink" title="创建操作"></a>创建操作</h4><p>可以使用<code>document.createComment()</code>方法创建注释节点。</p>
<h3 id="CDATASection类型"><a href="#CDATASection类型" class="headerlink" title="CDATASection类型"></a>CDATASection类型</h3><p>CDATASection类型只针对基于XML的文档，表示的是CDATA区域。它继承自Text类型，因此拥有除了<code>splitText()</code>之外的所有字符串操作方法。</p>
<h4 id="属性-5"><a href="#属性-5" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType：4</li>
<li>nodeName：”#cdata-section”</li>
<li>nodeValue：CDATA区域的内容</li>
<li>parentNode：Document、Element</li>
<li>childNodes：无</li>
</ul>
<h4 id="创建操作-3"><a href="#创建操作-3" class="headerlink" title="创建操作"></a>创建操作</h4><p>可以使用<code>document.createCDATASection()</code>方法创建CDATA区域。</p>
<h3 id="DocumentType类型"><a href="#DocumentType类型" class="headerlink" title="DocumentType类型"></a>DocumentType类型</h3><p>包含着与文档的doctype有关的所有信息。在DOM1级中，DocumentType对象不能动态创建，而只能通过解析文档代码的方式来创建。</p>
<h4 id="属性-6"><a href="#属性-6" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType：10</li>
<li>nodeName：doctype的名称</li>
<li>nodeValue：null</li>
<li>parentNode：Document</li>
<li>childNodes：无</li>
<li>name：文档类型的名称</li>
<li>entities：文档类型描述的实体的NamedNodeMap对象</li>
<li>notations：文档类型描述的符号的NamedNodeMap对象</li>
</ul>
<h3 id="DocumentFragment类型"><a href="#DocumentFragment类型" class="headerlink" title="DocumentFragment类型"></a>DocumentFragment类型</h3><p>在所有节点类型中，只有DocumentFragment在文档中没有对应的标记。DOM将其规定为一种轻量级的文档，可以包含和控制节点，但不像完整文档一样占用额外的资源。</p>
<h4 id="属性-7"><a href="#属性-7" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType：11</li>
<li>nodeName：”#document-fragment”</li>
<li>nodeValue：null</li>
<li>parentNode：null</li>
<li>childNodes：Element、ProcessingInstruction、Comment、Text、CDATASection、EntityReference</li>
</ul>
<h4 id="创建操作-4"><a href="#创建操作-4" class="headerlink" title="创建操作"></a>创建操作</h4><p>可以使用<code>document.createDoumentFragment()</code>方法创建文档片段。虽然不能将文档片段直接添加到文档中，但可以将其作为一个仓库来使用，即可以在里面保存将来可能会添加到文档中的节点。不过新节点尚未被添加到文档树中，可以使用<code>appendChild()</code>等来将其进行添加。对于文档片段来说，添加的过程实际上是将文档片段的所有子节点添加到相应位置并从文档片段中删除，而文档片段本身并不会成为文档树的一部分。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fragment = <span class="built_in">document</span>.createDoumentFragment();</span><br></pre></td></tr></table></figure>
<p>如果我们想添加多个元素，但又不想要一个个地添加而产生的反复渲染，可以使用文档片段。举个例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;myList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向其中添加三个列表项</span></span><br><span class="line"><span class="keyword">var</span> fragment = <span class="built_in">document</span>.createDoumentFragment();</span><br><span class="line"><span class="keyword">var</span> ul = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myList&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> li = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">    li = <span class="built_in">document</span>.createElement(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">    li.appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">&quot;Item&quot;</span> + (i+<span class="number">1</span>)));</span><br><span class="line">    fragment.appendChild(li);</span><br><span class="line">&#125;</span><br><span class="line">ul.appendChild(fragment);</span><br></pre></td></tr></table></figure>

<h3 id="Attr类型"><a href="#Attr类型" class="headerlink" title="Attr类型"></a>Attr类型</h3><p>为元素的特性，从技术角度讲，特性就是存在于元素的attributes属性中的节点。</p>
<h4 id="属性-8"><a href="#属性-8" class="headerlink" title="属性"></a>属性</h4><ul>
<li>nodeType：2</li>
<li>nodeName：特性的名</li>
<li>nodeValue：特性的值</li>
<li>parentNode：null</li>
<li>childNodes：在HTML中无；在XML中可以为Text或EntityReference</li>
<li>name：特性的名</li>
<li>value：特性的值</li>
<li>specified：布尔值，用于区别特性是在代码中指定的还是默认的</li>
</ul>
<h4 id="创建操作-5"><a href="#创建操作-5" class="headerlink" title="创建操作"></a>创建操作</h4><p>可以使用<code>document.createAttribute()</code>方法创建特性节点。若想将新创建的特性添加到元素中，必须使用元素的<code>setAttributeNode()</code>方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> attr = <span class="built_in">document</span>.createAttribute(<span class="string">&quot;align&quot;</span>);</span><br><span class="line">attr.value = <span class="string">&quot;left&quot;</span>;</span><br><span class="line">element.setAttributeNode(attr);</span><br><span class="line"></span><br><span class="line">alert(element.attributes[<span class="string">&quot;align&quot;</span>].value);        <span class="comment">// &quot;left&quot;</span></span><br><span class="line">alert(element.getAttributeNode[<span class="string">&quot;align&quot;</span>].value);  <span class="comment">// &quot;left&quot;</span></span><br><span class="line">alert(element.getAttribute(<span class="string">&quot;align&quot;</span>));            <span class="comment">// &quot;left&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="DOM操作技术"><a href="#DOM操作技术" class="headerlink" title="DOM操作技术"></a>DOM操作技术</h2><p>我们知道，很多时候我们可以借助DOM做一些和浏览器交互的操作。</p>
<h3 id="动态脚本"><a href="#动态脚本" class="headerlink" title="动态脚本"></a>动态脚本</h3><p>动态脚本指的是，在页面加载时不存在，但将来的某一时刻通过修改DOM动态添加的脚本。有两种创建方式：插入外部文件、直接插入JavaScript代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插入外部文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadScript</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">    script.type = <span class="string">&quot;text/javascript&quot;</span>;</span><br><span class="line">    script.src = url;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(script);</span><br><span class="line">&#125;</span><br><span class="line">loadScript(<span class="string">&quot;main.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接插入代码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadScriptString</span>(<span class="params">code</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">    script.type = <span class="string">&quot;text/javascript&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;                                        <span class="comment">// 标准语法，IE中报错</span></span><br><span class="line">        script.appendChild(<span class="built_in">document</span>.createTextNode(code));</span><br><span class="line">    &#125; <span class="keyword">catch</span>(ex) &#123;                                <span class="comment">// 另一语法，IE中可用</span></span><br><span class="line">        script.text = code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(script);</span><br><span class="line">&#125;</span><br><span class="line">loadScriptString(<span class="string">&quot;function sayHi() &#123;alert(&#x27;Hi&#x27;);&#125;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="动态样式"><a href="#动态样式" class="headerlink" title="动态样式"></a>动态样式</h3><p>动态样式指的是，在页面加载时不存在，加载完成后动态添加到页面中的样式。有两种创建方式：插入外部文件(用&lt;link&gt;的)、直接插入代码(用用&lt;style&gt;的)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插入外部文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadStyles</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> link = <span class="built_in">document</span>.createElement(<span class="string">&quot;link&quot;</span>);</span><br><span class="line">    link.rel = <span class="string">&quot;stylesheet&quot;</span>;</span><br><span class="line">    link.type = <span class="string">&quot;text/css&quot;</span>；</span><br><span class="line">    link.href = url;</span><br><span class="line">    <span class="keyword">var</span> head = <span class="built_in">document</span>.getElementByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">    head.appendChild(link);</span><br><span class="line">&#125;</span><br><span class="line">loadStyles(<span class="string">&quot;style.css&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接插入代码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadStyleString</span>(<span class="params">code</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> style = <span class="built_in">document</span>.createElement(<span class="string">&quot;style&quot;</span>);</span><br><span class="line">    style.type = <span class="string">&quot;text/css&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        style.appendChild(<span class="built_in">document</span>.createTextNode(code));</span><br><span class="line">    &#125; <span class="keyword">catch</span>(ex) &#123;</span><br><span class="line">        style.styleSheet.cssText = code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> head = <span class="built_in">document</span>.getElementByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">    head.appendChild(style);</span><br><span class="line">&#125;</span><br><span class="line">loadStyleString(<span class="string">&quot;body&#123;background-color:red&#125;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="操作表格"><a href="#操作表格" class="headerlink" title="操作表格"></a>操作表格</h3><p>&lt;table&gt;元素是HTML中最复杂的结构之一，表格的创建一般都必须涉及表格行、单元格、表头等方面的标签，用DOM方法创建就会很复杂。为了方便，DOM为&lt;table&gt;、&lt;tbody&gt;、&lt;tr&gt;元素添加了一些方法。<br>为table添加的属性和方法：</p>
<ul>
<li>caption：指向&lt;caption&gt;元素的指针</li>
<li>tBodies：一个&lt;tbody&gt;元素的HTMLCollection</li>
<li>tFoot：指向&lt;tFoot&gt;元素的指针</li>
<li>tHead：指向&lt;tHead&gt;元素的指针</li>
<li>rows：表格中所有行的HTMLCollection</li>
<li>createTHead()</li>
<li>createTFoot()</li>
<li>createCaption()</li>
<li>deleteTHead()</li>
<li>deleteTFoot()</li>
<li>deleteCaption()</li>
</ul>
<p>为tbody添加的属性和方法：</p>
<ul>
<li>deleteRow(pos)</li>
<li>insertRow(pos)</li>
</ul>
<p>为tr添加的属性和方法：</p>
<ul>
<li>cells：tr中所有单元格的HTMLCollection</li>
<li>deleteCell(pos)</li>
<li>insertCell(pos)</li>
</ul>
<p>举个例子，如想创建一个表格，用原始的DOM操作(左)和用DOM提供的便捷操作(右)：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Cell 1, 1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Cell 2, 1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Cell 1, 2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Cell 2, 2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tobdy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/js-note-10/comparison.png" class="" title="comparison">

<h3 id="使用NodeList"><a href="#使用NodeList" class="headerlink" title="使用NodeList"></a>使用NodeList</h3><p>上文提到了三个动态的集合：NodeList、NamedNodeMap、HTMLCollection，每当文档结构发生变化时，它们都会得到更新。本质上说，所有以上三者的对象都是在访问DOM文档时实时运行的查询。因此会遇到一些问题，举例如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> divs = <span class="built_in">document</span>.getElementByTagName(<span class="string">&quot;div&quot;</span>), i, div;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误代码</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; divs.length; i++) &#123;</span><br><span class="line">    div = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确操作</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span> ,len = divs.length; i &lt; len; i++) &#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>这里会进入一个死循环，因为每次循环都要对length求值，也就是所有div元素的查询。但每次进入循环后都会创建一个新的div元素并添加入文档，因此divs.length会在每次循环后递增。i和divs.length同步递增，因此它们永远不会相等，是一个死循环。解决办法：保存最初的divs.length的快照。<br>一般来说要减少对它们的访问，因为每次访问三种动态集合，都会运行一次基于文档的查询，建议是将值缓存起来。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/DOM/" rel="tag"># DOM</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/js-note-9/" rel="prev" title="JavaScript学习笔记(9)">
      <i class="fa fa-chevron-left"></i> JavaScript学习笔记(9)
    </a></div>
      <div class="post-nav-item">
    <a href="/dont-be-fragile/" rel="next" title="Stop crying your heart out">
      Stop crying your heart out <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%B1%82%E6%AC%A1"><span class="nav-number">1.</span> <span class="nav-text">节点层次</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Node%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.</span> <span class="nav-text">Node类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7"><span class="nav-number">1.1.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%85%B3%E7%B3%BB"><span class="nav-number">1.1.2.</span> <span class="nav-text">节点关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.3.</span> <span class="nav-text">节点操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Document%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">Document类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E6%93%8D%E4%BD%9C"><span class="nav-number">1.2.2.</span> <span class="nav-text">查找操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E6%93%8D%E4%BD%9C"><span class="nav-number">1.2.3.</span> <span class="nav-text">写入操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Element%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.</span> <span class="nav-text">Element类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-2"><span class="nav-number">1.3.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%80%A7%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.2.</span> <span class="nav-text">特性操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.3.</span> <span class="nav-text">创建操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Text%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.4.</span> <span class="nav-text">Text类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-3"><span class="nav-number">1.4.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.4.2.</span> <span class="nav-text">文本操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%93%8D%E4%BD%9C-1"><span class="nav-number">1.4.3.</span> <span class="nav-text">创建操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Comment%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.5.</span> <span class="nav-text">Comment类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-4"><span class="nav-number">1.5.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%93%8D%E4%BD%9C-2"><span class="nav-number">1.5.2.</span> <span class="nav-text">创建操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CDATASection%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.6.</span> <span class="nav-text">CDATASection类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-5"><span class="nav-number">1.6.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%93%8D%E4%BD%9C-3"><span class="nav-number">1.6.2.</span> <span class="nav-text">创建操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DocumentType%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.7.</span> <span class="nav-text">DocumentType类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-6"><span class="nav-number">1.7.1.</span> <span class="nav-text">属性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DocumentFragment%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.8.</span> <span class="nav-text">DocumentFragment类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-7"><span class="nav-number">1.8.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%93%8D%E4%BD%9C-4"><span class="nav-number">1.8.2.</span> <span class="nav-text">创建操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Attr%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.9.</span> <span class="nav-text">Attr类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-8"><span class="nav-number">1.9.1.</span> <span class="nav-text">属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%93%8D%E4%BD%9C-5"><span class="nav-number">1.9.2.</span> <span class="nav-text">创建操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DOM%E6%93%8D%E4%BD%9C%E6%8A%80%E6%9C%AF"><span class="nav-number">2.</span> <span class="nav-text">DOM操作技术</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E8%84%9A%E6%9C%AC"><span class="nav-number">2.1.</span> <span class="nav-text">动态脚本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%A0%B7%E5%BC%8F"><span class="nav-number">2.2.</span> <span class="nav-text">动态样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E8%A1%A8%E6%A0%BC"><span class="nav-number">2.3.</span> <span class="nav-text">操作表格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8NodeList"><span class="nav-number">2.4.</span> <span class="nav-text">使用NodeList</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt=""
      src="/images/avatar/avatar.jpg">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">51</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-rocket"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LemniscateX</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
